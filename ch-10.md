# cloud and virtualization security

- exploring the cloud
	- cloud computing: model for ubiquitous, convenient, on-demand network access to a shared pool of configurable computing resources
		- can be rapidly provisioned / released
	- allows oversubscription since not everyone will use all their resources at the same time
	- multitenancy
		- diff users share resources in same infra 
- benefits of cloud
	- on demand self service computing
	- scalability
		- vertical scaling
			- increase capacity of existing servers
		- horizontal scaling
			- add more servers
	- elasticity
		- capacity should expand and contract as needs change
	- measured service 
		- everything is tracked, so you pay for usage 
	- agility and flexibility
		- speed to provision cloud resources and ability to use them for a short time 
- cloud roles for orgs
	- cloud service providers 
		- firms that offer cloud computing services 
	- cloud consumers
	- cloud partners / brokers
		- orgs that offer products / services that support or integrate with cloud 
	- cloud auditors 
		- independent orgs that provide 3rd party assessments of cloud services / operations
	- cloud carriers
		- intermediaries that provide connectivity that allows delivery of cloud services from provider -> consumer
- cloud service models
	- infrastructure as a service (**IaaS**)
		- customers can buy compute / storage / networks 
		- ex: AWS, azure, GCP 
	- software as a service (**SaaS**)
		- provides access to fully managed applications running in the cloud
	- platform as a service (**PaaS**)
		- offers a platform where customers can run applications they've developed themselves 
		- cloud provider builds and runs the infra and offers customers an execution environment 
		- function as a service (**FaaS**)
			- example of PaaS
			- allows customers to upload their own code functions and the provider runs them on a scheduled basis 
			- ex: aws lambda
			- also referred to as serverless computing
	- managed services
		- managed service providers (MSPs) provide information technology as a service 
		- manages all IT or just pieces, like network design or cloud cost management 
		- when MSP provides security services, they're MSSPs (managed security service providers)
			- ex: vuln management, incident response, firewall mgmt
- cloud deployment models 
	- public cloud
		- infra available to anyone
		- supports all cloud service models 
		- ex: azure, aws, gcp
	- private cloud
		- cloud infra provisioned for use by a single customer
		- tend to have excess unused capacity
	- community cloud
		- multitenant, but only for people in that community
	- hybrid cloud
		- any blend of public / private / community cloud
		- more decentralized
		- ex: using private cloud, then switching to public if you run out of compute 
	- shared responsibility model
		- cloud customers must divide security responsibilities between cloud service providers and their own cyber teams 
		- responsibility matrix:
		- ![Pasted image 20240917163454](https://github.com/user-attachments/assets/74fad32d-27c4-47cb-8669-cbcc1fd80bf6)
	- cloud standards and guidelines 
		- NIST Cloud Reference Architecture is a taxonomy for cloud services (SP 500-292)
		- Cloud Security Alliance (CSA): org focused on developing and promoting best practices in cloud security
			- developed CCM (cloud controls matrix), which is a document to help organizations understand the appropriate use of cloud security controls and map them to regulatory standards
	- edge computing
		- to deal with issue of sensors being in remote locations with poor connection, sensors are given some processing power so they can preprocess data before sending it to the cloud 
	- fog computing
		- use IoT gateway devices near the sensors 
		- sensors send data to the gateway devices, which then processes the data and sends it to the cloud
	- virtualization
		- virtualization allows multiple guest systems to share the same underlying hardware
		- in a virtualized data center, the virtual host hardware runs an operating system called a **hypervisor**, which mediates access to the underlying hardware resources 
		- then, VMs run on top of the virtual infra provided by the hypervisor
		- hypervisors 
			- main responsibility: enforce isolation between virtual machines 
			- type 1 hypervisor 
				- aka bare metal hypervisors
				- operate directly on top of the underlying hardware
				- very efficient 
			- type 2 hypervisor
				- the hypervisor runs as an application on top of an existing OS 
				- normally used for VMs on personal devices
	- cloud infra components
		- cloud compute resources 
			- virtualization
				- VMs
			- containerization
				- provides application level virtualization
				- recommended ways to secure containers:
					- using container specific host operating systems (built with reduced features -> reduced attack surfaces)
					- segment containers by risk profile and purpose
					- use container specific vuln mgmt tools
		- cloud storage resources
			- block storage
				- allocates large volumes of storage for virtual server instances 
				- volumes are formatted as virtual disks and used like a physical drive 
				- ex: AWS EBS (elastic block storage)
			- object storage
				- customers place files in buckets and each file is an independent entity that can be accessed via web/API 
				- ex: AWS S3 (simple storage service)
			- security considerations
				- set permissions properly
				- consider high availability and durability options
				- encrypt sensitive data
		- cloud networking
			- security groups
				- security groups define permissible network traffic 
				- consist of rules for network traffic
			- virtual private cloud (VPC)
				- segmentation allows different security levels / functions on different subnets 
				- on a physical network: segmentation via VLANs (virtual LANs)
				- in the cloud, VPCs (virtual private cloud) do the same thing
					- systems can be grouped into subnets using VPCs and designate them as private or public 
				- VPC endpoints: allowing VPCs to connect to each other via cloud provider's network backbone
				- cloud transit gateways: allowing interconnection between on cloud VPC and on prem VLANs (for hybrid cloud operations)
		- devops and cloud automation
			- Infrastructure as code (IaC)
				- automating provisioning / managment / deprovisioning of infra services through scripted code, not human intervention
				- ex: AWS CloudFormation
					- lets you specify infra with json / yaml
				- APIs are especially helpful for cloud environments with microservices (cloud service offerings with very granular functions for other services)
	- cloud security issues 
		- availability
			- cloud has advantage of operating in many diff geographic locations, providing backup across regions, and operating in a high availability mode across diverse zones 
		- data sovereignty
			- data sovereignty: data is subject to legal restrictions of any jurisdiction where it is collected, stored, or processed
			- ensure you know where your data is 
		- virtualization security 
			- VM escape vulns: when attacker can escape a virtual host and intrude on other VMs
			- VM sprawl: when IaaS users create instances and forget / abandon them, leaving them to accrue costs and security issues 
			- resource reuse: when providers take hardware resources assigned to one person and assign them to another but don't properly remove the original customer's data
		- application security 
			- you should implement API inspection to make sure API requests don't have security issues 
			- secure web gateways (SWG): monitor web requests made by internal users and evaluate them against an org's security policy (application layer)
	- governance and auditing of third party vendors
		- customers should ensure their contracts allow them to audit the cloud provider 
	- hardening cloud infra 
		- third party controls can be expensive but can work with different cloud providers; controls offered by cloud provider can be user friendly and cost effective
		- cloud access security brokers (CASBs)
			- CASBs serve as intermediaries between cloud users and cloud service providers to monitor user activity and enforce policy requirements
			- inline CASB solutions 
				- reside in connection path between user and service 
				- requires configuration in network / endpoint devices 
				- allows CASB to see requests before it reaches the cloud provider, so it can block requests 
			- API-based CASB
				- interact directly w/ the cloud provider through the provider's API 
				- provides direct access to the cloud server and doesn't need any user device configuration
				- doesn't allow CASB to block requests and can only monitor activity
		- resource policies 
			- resource policies limit the actions a user can take 
				- ex: can only use resources in US regions, can only launch small server instances (cost)
		- secrets management 
			- hardware security modules (HSMs)
				- device that manages encryption keys and performs cryptographic operations efficiently 
				- expensive but very secure 
				- cloud service providers often use them internally and offer services to customers
