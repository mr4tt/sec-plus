## endpoint security

- OS vulnerabilities
	- ways OS can be vulnerable
		- vulns in OS itself can be exploited 
		- defaults (like default password, insecure settings) 
		- insecure configs 
		- misconfigs 
- hardware vulnerabilities
	- firmware: embedded software that allows devices to function
		- concerning because its attached to the device; reinstalling OS won't fix it 
	- end of life / legacy drives don't have support anymore
	- vendor terms
		- end of sales: last date something will be sold
		- end of life: will soon not be supported
		- end of support (aka legacy): not supported / updated
		- legacy: typically unsupported device / software
- protecting endpoints (endpoint devices of a network, whether wired or wireless)
	- preserving integrity from the moment a device boots up 
		- UEFI firmware (unified extensible firmware interface; replaced BIOS) has 2 techniques to keep system secure:
			- secure boot 
				- ensures system boots only with software the OEM trusts 
				- system has database listing secure signatures of trusted software / firmware 
			- measured boot
				- boot processes gets the has of each component (firmware, boot start drivers, etc) and stores that in the TPM (trusted platform module)
					- the TPM can later be checked to see system info / state
		- boot integrity starts with hardware root of trust, which holds cryptographic keys that secure the boot process, meaning the system inherently trusts the hardware root of trust 
			- a common implementation is the built in TPM chip, which has 3 major functions for system security
				- remote attestation (allows hardware + software config verification)
				- binding (encrypts data)
				- scaling (encrypts data and sets requirements for TPM chip state before decryption)
			- other examples:
				- serial numbers that can't be changed / cloned
				- PUFs (physically unclonable functions), which are unique to the hardware device
				- Apple's Secure Enclave, Google's Titan M 
			- hardware security modules (HSMs): external devices to create / store / manage digital keys 
			- key management systems (KMS): manages secrets (often offered by cloud providers)
	- endpoint security tools
		- antivirus / antimalware
			- signature based detection
				- uses a hash / pattern based signature to identify files 
				- less useful bc of methods like polymorphism and encryption
			- heuristic / behavior based detection
				- sees what actions a software takes and matches it to profiles of unwanted activity 
			- AI /ML
				- uses data to find ways to identify malware, which may include heuristic / signature / others
			- sandboxing 
				- isolate and run sample malicious code 
			- allow / deny lists 
			- endpoint detection and response (EDR)
				- these tools combine monitoring on endpoint devices with software and log analysis to collect / correlate / analyze events 
				- key features: search and explore collected data for investigations and detect suspicious data 
			- extended detection and response (XDR)
				- similar to EDR, but also tracks cloud services, email, security services etc, not just endpoints 
			- data loss prevention (DLP)
				- key features: classify data, data labeling / tagging, policy management and enforcement, monitoring / reporting 
				- ensures data doesn't leave the org 
		- network defenses 
			- host based firewalls (normal firewall)
			- host based intrusion prevention system (HIPS)
				- analyzes traffic before the host processes it 
				- can block or filter traffic 
			- host based intrusion detection system (HIDS)
				- similar to HIPS but can't block traffic, can only report / alert on issues 
- hardening techniques 
	- changing settings on a system to increase level of security + reduce vulnerability to attack 
	- service hardening
		- disable number of open ports and services 
	- network hardening
		- use VLANs to segment different trust levels / user groups / systems 
	- change default passwords
	- remove unnecessary software
	- OS hardening
		- change settings to match desired security stance 
			- ex: required password complexity, disable password storage, etc
		- SELinux (security enhanced linux)
			- provides additional security capabilities and options on top of an existing Linux distro
			- ex: mandatory access control (MAC) that can be enforced at user / file / system level 
		- configuration, standards, and schemas
			- config management tools
				- ex: Jamf, Configuration Manager for Windows, CFEngine
				1. establish baseline configurations and modify for specific groups / teams 
				2. deploy security baseline with central mgmt tools 
				3. once the baseline is set, tools support configuration enforcement
					- monitors for changes and ensures config remains in its desired state
			- patching 
				- patch management tools include Configuration Manager for Windows or other third party versions
			- encryption
				- FDE (full disk encryption) encrypts disk and requires bootloader provide encryption key 
					- implementations
						- transparent encryption
							- unencrypted during use
							- invisible to the user 
						- self encrypting drive (SED)
							- hardware level FDE
				- volume encryption
					- protects specific volumes of the drive 
- securing embedded and specialized systems
	- embedded systems
		- systems built into other devices, like cars or appliances
		- many use a real time operating system (RTOS)
			- OS used when priority needs to be placed on processing data as it comes in, rather than waiting for tasks to be handled first 
	- SCADA and ISC
		- these are often used interchangeably
		- ICS: industrial controls systems 
		- SCADA: supervisory control and data acquisition, usually for large systems that run power / water distribution or anything covering a large area
		- SCADA
			- type of system architecture that combined data acquisition and control devices / computers and an interface to control and monitor the entire architecture 
			- remote telemetry units (RTUs) collect data from sensors
			- programmable logic controllers (PLCs) control and collect data from industrial devices like machines or robots 
		- often designed without security in mind, isolation could be best 
	- IOT 
		- common issues:
			- poor security practices
			- short support lifespans
			- vendor data handling practice issues 
	- communication considerations
		- many embedded / specialized systems operate in environments where networks might not be available 
		- can use 5g / LTE, which needs to be secured 
		- physically secure SIMs
		- protocols like Zigbee provide low power, peer to peer communications 
	- security constraints of embedded systems
		- overall computational power and capability is much lower than a computer 
			- may not have enough compute for cryptographic processing and less capacity for tools like a firewall or antimalware
		- may not connect to a network 
			- hard to patch and monitor 
		- authentication may be impossible 
		- can be difficult to replace
- asset management
	- assets need to be added to asset inventories and tracked through their lifespan 
	- enumeration: scanning to identify assets 
	- decommissioning 
		- remove device from service, remove from inventory, ensure no sensitive data remains on the system 
		- wipe or destroy drives 
		- certification: documenting assets were decommissioned 
	- retention
		- retaining data / systems 
		- usually for legal or compliance reasons 
